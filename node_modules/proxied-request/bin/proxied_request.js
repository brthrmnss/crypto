var fs = require("fs")
var https = require("https")
var http = require("http")
var Url = require("url");

function save_file(url, resp, headers, res, options) {
    return;
    var fs = require('fs');
    var url_name = url.replace(/\W/g, '_')
    var filename = new Date().getTime() + '.txt'
    filename = url_name + '_' + filename;
    var contents = ''
    var obj = {}
    obj.url = url;
    obj.options = options
    if (options.pfx != null) {
        options.pfx = ''
    }
    obj.resp = resp
    obj.headers = headers
    //obj.res = res;
    //contents = JSON.stringify(obj)

    var cache = [];
    contents = JSON.stringify(obj, function (key, value) {
        if (typeof value === 'object' && value !== null) {
            if (cache.indexOf(value) !== -1) {
                // Circular reference found, discard key
                return;
            }
            // Store value in our collection
            cache.push(value);
        }
        return value;
    });
    cache = null; // Enable garbage collection

    fs.writeFile("c:/trash/proxydump/" + filename, contents, function (err) {
        if (err) {
            console.log(err);
        } else {
            console.log("The file was saved!");
        }
    });
}

function ProxyRequst() {
    var p = ProxyRequst.prototype;
    p.request = function request(url, data_callback, _headers, _params, req) {
        pfx = 'testengineering-user.pfx'
        console.log(__filename, __dirname)
        pfx = fs.readFileSync("./" + pfx)
        var passphrase = 'changeit'


//var base = 'C:/certsz'
//var cert
//var pfx = 'k.pfx'

//console.log(pfx.length, pfx)


        var url_ = 'https://isowebservicesimp.paychex.com/portal_service/PortalService'//#?WSDL'
        url_ = 'http://vcisossgdvs3/portal_service/PortalService'
        url_ = 'https://isowebservicesimp.paychex.com/portal_service/PortalService'
        url_ = 'https://webservicesimp.paychex.com/subscription_service/SubscriptionService'
        url_ = 'no url sent'
//url = 'http://vcintssgdvs3.paychex.com/subscription_service/SubscriptionService'
        if (url == null) {
            url = url_;
        }
        var request = 'request2.txt'
        request = 'sub.request.txt'
        request = fs.readFileSync('./' + request, 'utf8')


        var pathname = Url.parse(url).pathname
        var path = Url.parse(url).path
        var host = Url.parse(url).host
        var port = Url.parse(url).port
        if (host == null) {
            console.error('host is null', url, 'canceling request')
            return;
        }
        if (host.indexOf(':') != -1) //prevent dns.js errors
            host = host.replace(':' + port, '')
        var useHttps = url.slice(0, 5) == 'https'

        var txt = ""


        var headers = {
            //"Accept": "text/xml",
            // "user": 'test-entineering',
            //"Accept-Encoding": "gzip,deflate",
            "Accept": "text/xml",
            "Content-Type": "text/xml;charset=UTF-8",
            //"SOAPAction": '"http://xml.paychex.com/paychex/enterprise/subscription/v2/ws/ISubscriptionService/getEnterpriseUser"'
            //  'User-Agent': 'Jakarta Commons-HttpClient/3.1'
            "Connection": "Keep-Alive",
            //"Content-length": request.length,
            "Content-Length": request.length,
            //"Content-Type": "text/xml;charset=UTF-8",
        }

        function clone(obj) {
            if (obj == null || typeof(obj) != 'object')
                return obj;

            var temp = obj.constructor(); // changed

            for (var key in obj)
                temp[key] = clone(obj[key]);
            return temp;
        }

        var orig_headers = clone(_headers)
        if (_headers != null) {
            headers = _headers;
        }

        delete headers['accept-encoding'];
        headers['accept-encoding'] = 'text/html text/xml'
        delete headers['host'];
        //use connect-gzip
        //https://github.com/nateps/connect-gzip/blob/master/lib/gzip.js

        //http://stackoverflow.com/questions/4594654/node-js-proxy-dealing-with-gzip-decompression
        if (_params != null) {
            request = _params;
        }

        var options = { host: host, path: path, method: "POST", pfx: pfx//+'f'
            , passphrase: passphrase, headers: headers, port: port
        }
        //use Proxy to verify the request ....
        var useProxy = false
        //useProxy = true
        if (useProxy) {
            console.log('path', options.host, options)

            options.port = 80
            var start = 'http://'
            if (useHttps) {
                options.port = 443
                start = 'https://'
            }


            options.path = start + options.host + ':' + options.port + options.path;

            //options.path = 'https://' + options.host + ':' + options.port + options.path;
            options.headers.host = options.host;
            options.host = '127.0.0.1';
            options.port = 8088;

            console.log('path', options.path)
        }
        console.log();

//console.log(options)

//var ca = fs.readFileSync("./ca.crt")
        var agent = new https.Agent('d')//{ host: "localhost", port: 1337})//, ca: ca })
        var callback = function (res) {
            if (useHttps) {
                if (res.client.authorized) {
                    //console.log("node test: OK")
                    //console.log('done')
                } else {
                    console.log('res.client.authorizationError', res.client.authorizationError)
                    // throw new Error(res.client.authorizationError)
                }
            }

            var str = ''
            res.on('data', function (chunk) {
                //str += chunk;
                //WHy binary?
                str += chunk.toString('binary')
                //console.log('chunk', chunk.toString())
                //str += chunk//.toString('binary')
            });

            res.on('end', function () {
                    //console.log(str.indexOf('Authentication'))

                    //console.log(debugName, "\n");
                    //console.log(debugName,'result for ', url + ':', options.method);

                    var lines = str.split("\n\r")
                    /*console.log(lines)
                     console.log(lines.length)
                     //return;
                     if (lines[0].indexOf('uuid') != -1) {
                     lines.shift()
                     str = lines.join("\n")

                     }
                     if (lines.length > 1) {
                     for (var i = 0; i < lines.length; i++) {
                     var line = lines[i]
                     if (line.indexOf('--uuid')!= -1 ) continue;
                     }
                     }*/
                    //if ( postOUtput )
                    //console.log(str);

                    if (data_callback != null) {
                        data_callback(str, res.headers);
                        save_file(url, str, res.headers, res, options)
                    }
                }
            )
            ;


        }
        var getRequest = false
        if (req != null && req != undefined) {
            if (req.method != null && req.method.toUpperCase() == 'GET') {
                options.method = 'GET'
                getRequest = true;
            }
        }
//useHttps=falpse
        //console.log(options)
        if (useHttps) {
            //console.log('proxied_request','request', options)
            var post_req = https.request(options, callback)
        } else {
            //console.log(options)
            //use original headers
            /*options.headers = orig_headers
             options.port = 80
             delete options['pfx']
             delete options['passphrase']
             delete options['port']
             console.log('proxied_request','request', options)*/
            delete options['pfx']
            delete options['passphrase']
            //delete options['port'] //why delete port?
            //options.host = '127.0.0.1'
            //options.port = 8088
            console.log('proxied_request', 'request', options)
            var post_req = http.request(options, callback)
        }
        post_req.on('error', function (e) {
            console.error('proxied_request', 'error');
            console.error(e);
        });
// post the data
        if (getRequest) {
            post_req.end();
            return
        }
        post_req.write(request);
        post_req.end();

    }
}

exports.ProxyRequest = ProxyRequst;


function test() {

    var url = 'http://vcintssgdvs3.paychex.com/subscription_service/SubscriptionService'
    var p = new ProxyRequst()

    /* p.request(url, function onDone(data) {
     console.log('data', data)
     })*/

    var get_url = 'https://webservicesimp.paychex.com/reportingUser_service/ReportingUserService?WSDL'
    var url = 'https://isowebservicesimp.paychex.com/portal_service/PortalService'

    url = 'http://dev-d-40f9n.paychex.com:8088/mockPortalService/GetUserInfoApps'

    //var url = 'https://isowebservicesimpn.paychex.com/portal_service/PortalService'
    // var url = 'http://dev-d-40f9n.paychex.com:8088/mockPortalService'
    var headers = { 'content-type': 'text/xml;charset="utf-8"',
        'accept-encoding': 'gzip',
        soapaction: '"http://xml.paychex.com/paychex/enterprise/portal/v2/ws/IPortalService/GetUserClientsApps"',
        accept: 'text/xml, multipart/related, text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2',
        'user-agent': 'Oracle JAX-WS 2.1.5',
        // host: 'dev-d-20m76.paychex.com:7111', //avoid tls error ....
        connection: 'Keep-Alive',
        'content-length': '2560',
        'x-forwarded-for': '10.49.209.163',
        'x-forwarded-port': '7111',
        'x-forwarded-proto': 'http' }

    var params = '<?xml version=\'1.0\' encoding=\'UTF-8\'?><S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/"><S:Header><ns2:messageInfoElement xmlns:ns2="http://schemas.paychex.com/enterprise/metadata/MessageInfo_1" xmlns:ns3="http://schemas.paychex.com/enterprise/metadata/OriginatorInfo_1" xmlns:ns4="http://schemas.paychex.com/enterprise/metadata/TimingInfo_1"><ns2:trackingId>dev-d-20m76-1435a3d4ada-1d</ns2:trackingId><ns2:messageFlowId>messageFlowId</ns2:messageFlowId><ns2:originatorInfo><ns3:srcSystem>sso.landing.ApplicationRemote.getUserInfo</ns3:srcSystem><ns3:modifiedBy>devshared1</ns3:modifiedBy><ns3:modified_DateTime>2014-01-03T17:50:39.116-05:00</ns3:modified_DateTime></ns2:originatorInfo></ns2:messageInfoElement></S:Header><S:Body><ns23:GetUserClientsApps xmlns:ns10="http://schemas.paychex.com/enterprise/keyValuePair/TypedKeyValuePair_2" xmlns:ns11="http://schemas.paychex.com/enterprise/metadata/MessageInfo_1" xmlns:ns12="http://schemas.paychex.com/enterprise/metadata/OriginatorInfo_1" xmlns:ns13="http://schemas.paychex.com/enterprise/metadata/TimingInfo_1" xmlns:ns14="http://schemas.paychex.com/enterprise/serviceResponse/ServiceResponseInfo_1" xmlns:ns15="http://schemas.paychex.com/enterprise/serviceResponse/ServiceResponse_1" xmlns:ns16="http://schemas.paychex.com/es/client/ClientAppAcct_1_0" xmlns:ns17="http://services.paychex.com/payx/MessageBoard_1_0" xmlns:ns18="http://schemas.paychex.com/es/client/EntRequestor_1_0" xmlns:ns19="http://schemas.paychex.com/es/client/ClientRelatedAppAcct_1_0" xmlns:ns2="http://schemas.paychex.com/es/client/EntAppRouting_1_0" xmlns:ns20="http://schemas.paychex.com/es/client/EntDataElement_1_0" xmlns:ns21="http://schemas.paychex.com/faults/GenericFault_1_0" xmlns:ns22="http://xml.paychex.com/paychex/enterprise/portal/v2/" xmlns:ns23="http://xml.paychex.com/paychex/enterprise/portal/v2/ws/" xmlns:ns24="http://schemas.paychex.com/enterprise/payx/UserLdapType_1" xmlns:ns3="http://schemas.paychex.com/es/client/ClientCAppAcct_1_0" xmlns:ns4="http://schemas.paychex.com/enterprise/client/ClientProductSubscription_1" xmlns:ns5="http://schemas.paychex.com/enterprise/product/Product_1" xmlns:ns6="http://schemas.paychex.com/es/client/ClientAcctRegisterMsg_1_0" xmlns:ns7="http://schemas.paychex.com/es/client/ClientData_1_0" xmlns:ns8="http://schemas.paychex.com/es/client/PostalAddress_1_0" xmlns:ns9="http://schemas.paychex.com/es/client/EntValidation_1_0"><ns23:SsoGuid>SSOGUIDREPL</ns23:SsoGuid><ns23:LdapType>EXTERNAL</ns23:LdapType></ns23:GetUserClientsApps></S:Body></S:Envelope>'


    function callReportingUserService() {

        url = 'https://webservicesimp.paychex.com/reportingUser_service/ReportingUserService'
        url = 'https://webservicesimpn.paychex.com/reportingUser_service/ReportingUserService'
        //url = 'http://vcintssgdvs3/reportingUser_service/ReportingUserService'
        headers['soapaction'] = '"http://xml.paychex.com/paychex/enterprise/report/v3/ws/IReportingUserServiceContract/getSecurityInfo"'
        headers['content-length'] = '10773'
        params = '<?xml version=\'1.0\' encoding=\'UTF-8\'?><S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/"><S:Header><ns2:typedKeyValuePairArray xmlns:ns2="http://schemas.paychex.com/enterprise/keyValuePair/TypedKeyValuePair_2"><ns2:values><ns2:Key>BypassCache</ns2:Key><ns2:Value>false</ns2:Value><ns2:Type>String</ns2:Type></ns2:values><ns2:values><ns2:Key>UpdateCache</ns2:Key><ns2:Value>true</ns2:Value><ns2:Type>String</ns2:Type></ns2:values></ns2:typedKeyValuePairArray><ns2:messageInfoElement xmlns:ns2="http://schemas.paychex.com/enterprise/metadata/MessageInfo_1" xmlns:ns3="http://schemas.paychex.com/enterprise/metadata/OriginatorInfo_1"><ns2:trackingId>dev-d-20m76-143719ad51d-19</ns2:trackingId><ns2:messageFlowId>messageFlowId</ns2:messageFlowId><ns2:originatorInfo><ns3:srcSystem>sso.appStartupRemote.getStartupData</ns3:srcSystem><ns3:modifiedBy>candys_imp1</ns3:modifiedBy><ns3:modified_DateTime>2014-01-08T06:35:30.007-05:00</ns3:modified_DateTime></ns2:originatorInfo></ns2:messageInfoElement><WorkContext xmlns="http://oracle.com/weblogic/soap/workarea/">rO0ABXfwACF3ZWJsb2dpYy5hcHAuc3Vic2NyaXB0aW9uX3NlcnZpY2UAAADWAAAAI3dlYmxvZ2ljLndvcmthcmVhLlN0cmluZ1dvcmtDb250ZXh0ACpOUl9QTkdfQlVJTERfMjAxMzEyMjMxNDAwX1JDX3BuZzIwMTQtamFuXzMAG3dlYmxvZ2ljLmFwcC5wb3J0YWxfc2VydmljZQAAANYAAAAjd2VibG9naWMud29ya2FyZWEuU3RyaW5nV29ya0NvbnRleHQAKk5SX1BOR19CVUlMRF8yMDEzMTIxMzA5NTBfUkNfcG5nMjAxNC1qYW5fMwAA</WorkContext></S:Header><S:Body><ns36:getSecurityInfo xmlns:ns10="http://schemas.paychex.com/es/client/EntValidation_1_0" xmlns:ns11="http://schemas.paychex.com/enterprise/payxEntityId/PayxEntityId_1_0" xmlns:ns12="http://schemas.paychex.com/enterprise/keyValuePair/TypedKeyValuePair_2" xmlns:ns13="http://schemas.paychex.com/enterprise/metadata/MessageInfo_1" xmlns:ns14="http://schemas.paychex.com/enterprise/metadata/OriginatorInfo_1" xmlns:ns15="http://schemas.paychex.com/enterprise/metadata/TimingInfo_1" xmlns:ns16="http://schemas.paychex.com/enterprise/security/claims/Identity_3" xmlns:ns17="http://schemas.paychex.com/enterprise/security/claims/SecurityComponents_3" xmlns:ns18="http://schemas.paychex.com/enterprise/security/claims/Permission_2" xmlns:ns19="http://schemas.paychex.com/enterprise/serviceResponse/ServiceResponseInfo_1" xmlns:ns2="http://schemas.paychex.com/es/client/ClientAppAcct_1_0" xmlns:ns20="http://schemas.paychex.com/enterprise/serviceResponse/ServiceResponse_1" xmlns:ns21="http://services.paychex.com/payx/HRISClientEESelectorService_1_0" xmlns:ns22="http://www.hr-xml.org/3" xmlns:ns23="http://www.openapplications.org/oagis/9" xmlns:ns24="http://schemas.paychex.com/hris/client/benefits/BenefitsClient_1_0" xmlns:ns25="http://schemas.paychex.com/hris/client/benefits/BenefitsClient_2_0" xmlns:ns26="http://schemas.paychex.com/enterprise/worker/UserIdentifier_1" xmlns:ns27="http://schemas.paychex.com/es/client/EntRequestor_1_0" xmlns:ns28="http://schemas.paychex.com/es/client/ClientRelatedAppAcct_1_0" xmlns:ns29="http://schemas.paychex.com/es/client/EntDataElement_1_0" xmlns:ns3="http://schemas.paychex.com/es/client/EntAppRouting_1_0" xmlns:ns30="http://xml.paychex.com/paychex/enterprise/common/v2/GenericFault_2/" xmlns:ns31="http://xml.paychex.com/paychex/enterprise/common/v3/TypedKeyValuePair_3" xmlns:ns32="http://xml.paychex.com/paychex/enterprise/report/v1/Commands_1/" xmlns:ns33="http://xml.paychex.com/paychex/enterprise/report/v1/ReportingSession_1/" xmlns:ns34="http://xml.paychex.com/paychex/enterprise/report/v1/EnterpriseReporting_1/" xmlns:ns35="http://xml.paychex.com/paychex/enterprise/report/v3/ReportCenter" xmlns:ns36="http://xml.paychex.com/paychex/enterprise/report/v3/ws/" xmlns:ns4="http://schemas.paychex.com/es/client/ClientCAppAcct_1_0" xmlns:ns5="http://schemas.paychex.com/enterprise/client/ClientProductSubscription_1" xmlns:ns6="http://schemas.paychex.com/enterprise/product/Product_1" xmlns:ns7="http://schemas.paychex.com/es/client/ClientAcctRegisterMsg_1_0" xmlns:ns8="http://schemas.paychex.com/es/client/ClientData_1_0" xmlns:ns9="http://schemas.paychex.com/es/client/PostalAddress_1_0"><ns36:ssoGUID>00K2YZNBHGTN1G9909HA</ns36:ssoGUID><ns36:clientAccount><ns35:CAID>00K2YZNBH6XJKONT00BL</ns35:CAID><ns31:TypedKeyValuePairArray><ns31:values><ns31:Key>CLIENT</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">4189423</ns31:Value></ns31:values><ns31:values><ns31:Key>BRANCH</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">0741</ns31:Value></ns31:values></ns31:TypedKeyValuePairArray></ns36:clientAccount><ns36:clientAccount><ns35:CAID>00K2YZNBHCD4W6W40PWR</ns35:CAID><ns31:TypedKeyValuePairArray><ns31:values><ns31:Key>CLIENT</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">09165137</ns31:Value></ns31:values><ns31:values><ns31:Key>BRANCH</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">0027</ns31:Value></ns31:values></ns31:TypedKeyValuePairArray></ns36:clientAccount><ns36:clientAccount><ns35:CAID>00K2YZNBHDC1C83R0YLU</ns35:CAID><ns31:TypedKeyValuePairArray><ns31:values><ns31:Key>CLIENT</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">09165404</ns31:Value></ns31:values><ns31:values><ns31:Key>BRANCH</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">0027</ns31:Value></ns31:values></ns31:TypedKeyValuePairArray></ns36:clientAccount><ns36:clientAccount><ns35:CAID>00OD2K0PHCD513Y301EB</ns35:CAID><ns31:TypedKeyValuePairArray><ns31:values><ns31:Key>CLIENT</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">09165429</ns31:Value></ns31:values><ns31:values><ns31:Key>BRANCH</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">0027</ns31:Value></ns31:values></ns31:TypedKeyValuePairArray></ns36:clientAccount><ns36:clientAccount><ns35:CAID>00PJB0JCHDC1C71Q0YSL</ns35:CAID><ns31:TypedKeyValuePairArray><ns31:values><ns31:Key>CLIENT</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">09165443</ns31:Value></ns31:values><ns31:values><ns31:Key>BRANCH</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">0027</ns31:Value></ns31:values></ns31:TypedKeyValuePairArray></ns36:clientAccount><ns36:clientAccount><ns35:CAID>00K2YZNBHCS6MOJAN585</ns35:CAID><ns31:TypedKeyValuePairArray><ns31:values><ns31:Key>CLIENT</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">09165459</ns31:Value></ns31:values><ns31:values><ns31:Key>BRANCH</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">0027</ns31:Value></ns31:values></ns31:TypedKeyValuePairArray></ns36:clientAccount><ns36:clientAccount><ns35:CAID>00K2YZNBHDC1C83R0YN0</ns35:CAID><ns31:TypedKeyValuePairArray><ns31:values><ns31:Key>CLIENT</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">09165520</ns31:Value></ns31:values><ns31:values><ns31:Key>BRANCH</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">0027</ns31:Value></ns31:values></ns31:TypedKeyValuePairArray></ns36:clientAccount><ns36:clientAccount><ns35:CAID>00K2YZNBHCU3JKWS2DYL</ns35:CAID><ns31:TypedKeyValuePairArray><ns31:values><ns31:Key>CLIENT</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">09165542</ns31:Value></ns31:values><ns31:values><ns31:Key>BRANCH</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">0027</ns31:Value></ns31:values></ns31:TypedKeyValuePairArray></ns36:clientAccount><ns36:clientAccount><ns35:CAID>00OD2K0PHDC3BUY415O8</ns35:CAID><ns31:TypedKeyValuePairArray><ns31:values><ns31:Key>CLIENT</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">09165646</ns31:Value></ns31:values><ns31:values><ns31:Key>BRANCH</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">0027</ns31:Value></ns31:values></ns31:TypedKeyValuePairArray></ns36:clientAccount><ns36:clientAccount><ns35:CAID>00OD2K0PHDC3BUY415N7</ns35:CAID><ns31:TypedKeyValuePairArray><ns31:values><ns31:Key>CLIENT</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">09162720</ns31:Value></ns31:values><ns31:values><ns31:Key>BRANCH</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">0027</ns31:Value></ns31:values></ns31:TypedKeyValuePairArray></ns36:clientAccount><ns36:clientAccount><ns35:CAID>00K2YZNBHDC1C83R0YLT</ns35:CAID><ns31:TypedKeyValuePairArray><ns31:values><ns31:Key>CLIENT</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">09163079</ns31:Value></ns31:values><ns31:values><ns31:Key>BRANCH</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">0027</ns31:Value></ns31:values></ns31:TypedKeyValuePairArray></ns36:clientAccount><ns36:clientAccount><ns35:CAID>00TTEKWQHCD4M2H30GGV</ns35:CAID><ns31:TypedKeyValuePairArray><ns31:values><ns31:Key>CLIENT</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">07030912</ns31:Value></ns31:values><ns31:values><ns31:Key>BRANCH</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">0741</ns31:Value></ns31:values></ns31:TypedKeyValuePairArray></ns36:clientAccount></ns36:getSecurityInfo></S:Body></S:Envelope>'
    }

    /*
     url = 'https://webservicesimp.paychex.com/reportingUser_service/ReportingUserService'
     headers['soapaction'] = '"http://xml.paychex.com/paychex/enterprise/report/v3/ws/IReportingUserServiceContract/getSecurityInfo"'
     headers['content-length'] = '10773'
     params = '<?xml version=\'1.0\' encoding=\'UTF-8\'?><S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/"><S:Header><ns2:typedKeyValuePairArray xmlns:ns2="http://schemas.paychex.com/enterprise/keyValuePair/TypedKeyValuePair_2"><ns2:values><ns2:Key>BypassCache</ns2:Key><ns2:Value>false</ns2:Value><ns2:Type>String</ns2:Type></ns2:values><ns2:values><ns2:Key>UpdateCache</ns2:Key><ns2:Value>true</ns2:Value><ns2:Type>String</ns2:Type></ns2:values></ns2:typedKeyValuePairArray><ns2:messageInfoElement xmlns:ns2="http://schemas.paychex.com/enterprise/metadata/MessageInfo_1" xmlns:ns3="http://schemas.paychex.com/enterprise/metadata/OriginatorInfo_1"><ns2:trackingId>dev-d-20m76-143719ad51d-19</ns2:trackingId><ns2:messageFlowId>messageFlowId</ns2:messageFlowId><ns2:originatorInfo><ns3:srcSystem>sso.appStartupRemote.getStartupData</ns3:srcSystem><ns3:modifiedBy>candys_imp1</ns3:modifiedBy><ns3:modified_DateTime>2014-01-08T06:35:30.007-05:00</ns3:modified_DateTime></ns2:originatorInfo></ns2:messageInfoElement><WorkContext xmlns="http://oracle.com/weblogic/soap/workarea/">rO0ABXfwACF3ZWJsb2dpYy5hcHAuc3Vic2NyaXB0aW9uX3NlcnZpY2UAAADWAAAAI3dlYmxvZ2ljLndvcmthcmVhLlN0cmluZ1dvcmtDb250ZXh0ACpOUl9QTkdfQlVJTERfMjAxMzEyMjMxNDAwX1JDX3BuZzIwMTQtamFuXzMAG3dlYmxvZ2ljLmFwcC5wb3J0YWxfc2VydmljZQAAANYAAAAjd2VibG9naWMud29ya2FyZWEuU3RyaW5nV29ya0NvbnRleHQAKk5SX1BOR19CVUlMRF8yMDEzMTIxMzA5NTBfUkNfcG5nMjAxNC1qYW5fMwAA</WorkContext></S:Header><S:Body><ns36:getSecurityInfo xmlns:ns10="http://schemas.paychex.com/es/client/EntValidation_1_0" xmlns:ns11="http://schemas.paychex.com/enterprise/payxEntityId/PayxEntityId_1_0" xmlns:ns12="http://schemas.paychex.com/enterprise/keyValuePair/TypedKeyValuePair_2" xmlns:ns13="http://schemas.paychex.com/enterprise/metadata/MessageInfo_1" xmlns:ns14="http://schemas.paychex.com/enterprise/metadata/OriginatorInfo_1" xmlns:ns15="http://schemas.paychex.com/enterprise/metadata/TimingInfo_1" xmlns:ns16="http://schemas.paychex.com/enterprise/security/claims/Identity_3" xmlns:ns17="http://schemas.paychex.com/enterprise/security/claims/SecurityComponents_3" xmlns:ns18="http://schemas.paychex.com/enterprise/security/claims/Permission_2" xmlns:ns19="http://schemas.paychex.com/enterprise/serviceResponse/ServiceResponseInfo_1" xmlns:ns2="http://schemas.paychex.com/es/client/ClientAppAcct_1_0" xmlns:ns20="http://schemas.paychex.com/enterprise/serviceResponse/ServiceResponse_1" xmlns:ns21="http://services.paychex.com/payx/HRISClientEESelectorService_1_0" xmlns:ns22="http://www.hr-xml.org/3" xmlns:ns23="http://www.openapplications.org/oagis/9" xmlns:ns24="http://schemas.paychex.com/hris/client/benefits/BenefitsClient_1_0" xmlns:ns25="http://schemas.paychex.com/hris/client/benefits/BenefitsClient_2_0" xmlns:ns26="http://schemas.paychex.com/enterprise/worker/UserIdentifier_1" xmlns:ns27="http://schemas.paychex.com/es/client/EntRequestor_1_0" xmlns:ns28="http://schemas.paychex.com/es/client/ClientRelatedAppAcct_1_0" xmlns:ns29="http://schemas.paychex.com/es/client/EntDataElement_1_0" xmlns:ns3="http://schemas.paychex.com/es/client/EntAppRouting_1_0" xmlns:ns30="http://xml.paychex.com/paychex/enterprise/common/v2/GenericFault_2/" xmlns:ns31="http://xml.paychex.com/paychex/enterprise/common/v3/TypedKeyValuePair_3" xmlns:ns32="http://xml.paychex.com/paychex/enterprise/report/v1/Commands_1/" xmlns:ns33="http://xml.paychex.com/paychex/enterprise/report/v1/ReportingSession_1/" xmlns:ns34="http://xml.paychex.com/paychex/enterprise/report/v1/EnterpriseReporting_1/" xmlns:ns35="http://xml.paychex.com/paychex/enterprise/report/v3/ReportCenter" xmlns:ns36="http://xml.paychex.com/paychex/enterprise/report/v3/ws/" xmlns:ns4="http://schemas.paychex.com/es/client/ClientCAppAcct_1_0" xmlns:ns5="http://schemas.paychex.com/enterprise/client/ClientProductSubscription_1" xmlns:ns6="http://schemas.paychex.com/enterprise/product/Product_1" xmlns:ns7="http://schemas.paychex.com/es/client/ClientAcctRegisterMsg_1_0" xmlns:ns8="http://schemas.paychex.com/es/client/ClientData_1_0" xmlns:ns9="http://schemas.paychex.com/es/client/PostalAddress_1_0"><ns36:ssoGUID>00K2YZNBHGTN1G9909HA</ns36:ssoGUID><ns36:clientAccount><ns35:CAID>00K2YZNBH6XJKONT00BL</ns35:CAID><ns31:TypedKeyValuePairArray><ns31:values><ns31:Key>CLIENT</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">4189423</ns31:Value></ns31:values><ns31:values><ns31:Key>BRANCH</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">0741</ns31:Value></ns31:values></ns31:TypedKeyValuePairArray></ns36:clientAccount><ns36:clientAccount><ns35:CAID>00K2YZNBHCD4W6W40PWR</ns35:CAID><ns31:TypedKeyValuePairArray><ns31:values><ns31:Key>CLIENT</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">09165137</ns31:Value></ns31:values><ns31:values><ns31:Key>BRANCH</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">0027</ns31:Value></ns31:values></ns31:TypedKeyValuePairArray></ns36:clientAccount><ns36:clientAccount><ns35:CAID>00K2YZNBHDC1C83R0YLU</ns35:CAID><ns31:TypedKeyValuePairArray><ns31:values><ns31:Key>CLIENT</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">09165404</ns31:Value></ns31:values><ns31:values><ns31:Key>BRANCH</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">0027</ns31:Value></ns31:values></ns31:TypedKeyValuePairArray></ns36:clientAccount><ns36:clientAccount><ns35:CAID>00OD2K0PHCD513Y301EB</ns35:CAID><ns31:TypedKeyValuePairArray><ns31:values><ns31:Key>CLIENT</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">09165429</ns31:Value></ns31:values><ns31:values><ns31:Key>BRANCH</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">0027</ns31:Value></ns31:values></ns31:TypedKeyValuePairArray></ns36:clientAccount><ns36:clientAccount><ns35:CAID>00PJB0JCHDC1C71Q0YSL</ns35:CAID><ns31:TypedKeyValuePairArray><ns31:values><ns31:Key>CLIENT</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">09165443</ns31:Value></ns31:values><ns31:values><ns31:Key>BRANCH</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">0027</ns31:Value></ns31:values></ns31:TypedKeyValuePairArray></ns36:clientAccount><ns36:clientAccount><ns35:CAID>00K2YZNBHCS6MOJAN585</ns35:CAID><ns31:TypedKeyValuePairArray><ns31:values><ns31:Key>CLIENT</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">09165459</ns31:Value></ns31:values><ns31:values><ns31:Key>BRANCH</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">0027</ns31:Value></ns31:values></ns31:TypedKeyValuePairArray></ns36:clientAccount><ns36:clientAccount><ns35:CAID>00K2YZNBHDC1C83R0YN0</ns35:CAID><ns31:TypedKeyValuePairArray><ns31:values><ns31:Key>CLIENT</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">09165520</ns31:Value></ns31:values><ns31:values><ns31:Key>BRANCH</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">0027</ns31:Value></ns31:values></ns31:TypedKeyValuePairArray></ns36:clientAccount><ns36:clientAccount><ns35:CAID>00K2YZNBHCU3JKWS2DYL</ns35:CAID><ns31:TypedKeyValuePairArray><ns31:values><ns31:Key>CLIENT</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">09165542</ns31:Value></ns31:values><ns31:values><ns31:Key>BRANCH</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">0027</ns31:Value></ns31:values></ns31:TypedKeyValuePairArray></ns36:clientAccount><ns36:clientAccount><ns35:CAID>00OD2K0PHDC3BUY415O8</ns35:CAID><ns31:TypedKeyValuePairArray><ns31:values><ns31:Key>CLIENT</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">09165646</ns31:Value></ns31:values><ns31:values><ns31:Key>BRANCH</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">0027</ns31:Value></ns31:values></ns31:TypedKeyValuePairArray></ns36:clientAccount><ns36:clientAccount><ns35:CAID>00OD2K0PHDC3BUY415N7</ns35:CAID><ns31:TypedKeyValuePairArray><ns31:values><ns31:Key>CLIENT</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">09162720</ns31:Value></ns31:values><ns31:values><ns31:Key>BRANCH</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">0027</ns31:Value></ns31:values></ns31:TypedKeyValuePairArray></ns36:clientAccount><ns36:clientAccount><ns35:CAID>00K2YZNBHDC1C83R0YLT</ns35:CAID><ns31:TypedKeyValuePairArray><ns31:values><ns31:Key>CLIENT</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">09163079</ns31:Value></ns31:values><ns31:values><ns31:Key>BRANCH</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">0027</ns31:Value></ns31:values></ns31:TypedKeyValuePairArray></ns36:clientAccount><ns36:clientAccount><ns35:CAID>00TTEKWQHCD4M2H30GGV</ns35:CAID><ns31:TypedKeyValuePairArray><ns31:values><ns31:Key>CLIENT</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">07030912</ns31:Value></ns31:values><ns31:values><ns31:Key>BRANCH</ns31:Key><ns31:Value xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xs:string">0741</ns31:Value></ns31:values></ns31:TypedKeyValuePairArray></ns36:clientAccount></ns36:getSecurityInfo></S:Body></S:Envelope>'
     */

    //bad url
    //url = 'https://webservicesidmp.paychex.com/reportingUser_service/ReportingUserService'


    var ssoguidrepl = 'SSOGUIDREPL'
    var devshr3 = '007S6KM1H0JSPI3U01O9'
    var n = '00K2YZNBHGTN1G9909HA'
    params = params.replace(ssoguidrepl, n)

    /*
     //portal
     url = 'https://isowebservicesimpn.paychex.com/portal_service/PortalService'
     url = 'https://isowebservicesimp.paychex.com/portal_service/PortalService'
     params = '<?xml version="1.0" encoding="UTF-8"?><S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/"><S:Header><ns2:messageInfoElement xmlns:ns2="http://schemas.paychex.com/enterprise/metadata/MessageInfo_1" xmlns:ns3="http://schemas.paychex.com/enterprise/metadata/OriginatorInfo_1" xmlns:ns4="http://schemas.paychex.com/enterprise/metadata/TimingInfo_1"><ns2:trackingId>dev-d-20m76-1438945dc9f-28</ns2:trackingId><ns2:messageFlowId>messageFlowId</ns2:messageFlowId><ns2:originatorInfo><ns3:srcSystem>sso.landing.ApplicationRemote.getUserInfo</ns3:srcSystem><ns3:modifiedBy>Coffeeadmin112</ns3:modifiedBy><ns3:modified_DateTime>2014-01-12T21:12:03.657-05:00</ns3:modified_DateTime></ns2:originatorInfo></ns2:messageInfoElement></S:Header><S:Body><ns23:GetUserClientsApps xmlns:ns10="http://schemas.paychex.com/enterprise/keyValuePair/TypedKeyValuePair_2" xmlns:ns11="http://schemas.paychex.com/enterprise/metadata/MessageInfo_1" xmlns:ns12="http://schemas.paychex.com/enterprise/metadata/OriginatorInfo_1" xmlns:ns13="http://schemas.paychex.com/enterprise/metadata/TimingInfo_1" xmlns:ns14="http://schemas.paychex.com/enterprise/serviceResponse/ServiceResponseInfo_1" xmlns:ns15="http://schemas.paychex.com/enterprise/serviceResponse/ServiceResponse_1" xmlns:ns16="http://schemas.paychex.com/es/client/ClientAppAcct_1_0" xmlns:ns17="http://services.paychex.com/payx/MessageBoard_1_0" xmlns:ns18="http://schemas.paychex.com/es/client/EntRequestor_1_0" xmlns:ns19="http://schemas.paychex.com/es/client/ClientRelatedAppAcct_1_0" xmlns:ns2="http://schemas.paychex.com/es/client/EntAppRouting_1_0" xmlns:ns20="http://schemas.paychex.com/es/client/EntDataElement_1_0" xmlns:ns21="http://schemas.paychex.com/faults/GenericFault_1_0" xmlns:ns22="http://xml.paychex.com/paychex/enterprise/portal/v2/" xmlns:ns23="http://xml.paychex.com/paychex/enterprise/portal/v2/ws/" xmlns:ns24="http://schemas.paychex.com/enterprise/payx/UserLdapType_1" xmlns:ns3="http://schemas.paychex.com/es/client/ClientCAppAcct_1_0" xmlns:ns4="http://schemas.paychex.com/enterprise/client/ClientProductSubscription_1" xmlns:ns5="http://schemas.paychex.com/enterprise/product/Product_1" xmlns:ns6="http://schemas.paychex.com/es/client/ClientAcctRegisterMsg_1_0" xmlns:ns7="http://schemas.paychex.com/es/client/ClientData_1_0" xmlns:ns8="http://schemas.paychex.com/es/client/PostalAddress_1_0" xmlns:ns9="http://schemas.paychex.com/es/client/EntValidation_1_0"><ns23:SsoGuid>00K2YZNBHKWT398U0BUG</ns23:SsoGuid><ns23:LdapType>EXTERNAL</ns23:LdapType></ns23:GetUserClientsApps></S:Body></S:Envelope>'
     headers['soapaction'] = '"http://xml.paychex.com/paychex/enterprise/portal/v2/ws/IPortalService/GetUserClientsApps"'
     headers['content-length'] = '2564'
     */

    function postRequest(url, headers, params) {
        var p = new ProxyRequst()
        p.request(url, function onDone(data) {
            console.log('data post:', data)
        }, headers, params)
    }


    function testClientProductSubscription() {
        var url = 'http://vcintssgdvs3/CltProdSubService/ClientProductSubscription';
        var headers = { 'content-type': 'text/xml;charset="utf-8"',
            'accept-encoding': 'gzip',
            soapaction: '"http://xml.paychex.com/paychex/enterprise/subscription/v2/ws/ISubscriptionService/getEnterpriseUser"',
            accept: 'text/xml, multipart/related, text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2',
            'user-agent': 'Oracle JAX-WS 2.1.5',
            host: '127.0.0.1:7112',
            connection: 'Keep-Alive',
            'content-length': '7966' }
        var params = "<?xml version='1.0' encoding='UTF-8'?><S:Envelope xmlns:S=\"http://schemas.xmlsoap.org/soap/envelope/\"><S:Header><WorkContext xmlns=\"http://oracle.com/weblogic/soap/workarea/\">rO0ABXoAAALWACF3ZWJsb2dpYy5hcHAuc3Vic2NyaXB0aW9uX3NlcnZpY2UAAADWAAAAI3dlYmxvZ2ljLndvcmthcmVhLlN0cmluZ1dvcmtDb250ZXh0ACpOUl9QTkdfQlVJTERfMjAxNDAxMTAxMDQ4X1JDX3BuZzIwMTQtamFuXzQAIHdlYmxvZ2ljLmFwcC5lbnRpdGxlbWVudF9zZXJ2aWNlAAAA1gAAACN3ZWJsb2dpYy53b3JrYXJlYS5TdHJpbmdXb3JrQ29udGV4dAAqTlJfUE5HX0JVSUxEXzIwMTQwMjA0MTcxNF9SQ19wbmcyMDE0LW1hcl8zABl3ZWJsb2dpYy5hcHAubG9ic3ZjcG9sYm9sAAAA1gAAACN3ZWJsb2dpYy53b3JrYXJlYS5TdHJpbmdXb3JrQ29udGV4dAAjTlJfUE5HX0JVSUxEXzIwMTMwODA1MTQxMF9SQ19SNi4yXzEAIXdlYmxvZ2ljLmFwcC5wbmdVc2VyU3RvcmVfc2VydmljZQAAANYAAAAjd2VibG9naWMud29ya2FyZWEuU3RyaW5nV29ya0NvbnRleHQAKk5SX1BOR19CVUlMRF8yMDEzMTIzMTE2MDRfUkNfcG5nMjAxNC1qYW5fNgAud2VibG9naWMuYXBwLmNsaWVudFByb2R1Y3RTdWJzY3JpcHRpb25fc2VydmljZQAAANYAAAAjd2VibG9naWMud29ya2FyZWEuU3RyaW5nV29ya0NvbnRleHQAKk5SX1BOR19CVUlMRF8yMDE0MDIxMzExMzRfUkNfcG5nMjAxNC1tYXJfMgAbd2VibG9naWMuYXBwLnBvcnRhbF9zZXJ2aWNlAAAA1gAAACN3ZWJsb2dpYy53b3JrYXJlYS5TdHJpbmdXb3JrQ29udGV4dAArTlJfUE5HX0JVSUxEXzIwMTQwMjE4MTM0Ml9SQ19wbmcyMDE0LW1hcl8xOQAA</WorkContext></S:Header><S:Body><ns87:getEnterpriseUser xmlns:ns10=\"http://schemas.paychex.com/es/client/ClientAppAcct_1_0\" xmlns:ns11=\"http://schemas.paychex.com/es/client/EntAppRouting_1_0\" xmlns:ns12=\"http://schemas.paychex.com/es/client/ClientCAppAcct_1_0\" xmlns:ns13=\"http://schemas.paychex.com/es/client/ClientData_1_0\" xmlns:ns14=\"http://schemas.paychex.com/es/client/PostalAddress_1_0\" xmlns:ns15=\"http://schemas.paychex.com/es/client/EntValidation_1_0\" xmlns:ns16=\"http://schemas.paychex.com/es/fault/GenericFault_1_0\" xmlns:ns17=\"http://schemas.paychex.com/es/client/CltModMsg_1_0\" xmlns:ns18=\"http://schemas.paychex.com/es/client/EntDataElement_1_0\" xmlns:ns19=\"http://schemas.paychex.com/es/client/ClientLookupReq_1_0\" xmlns:ns2=\"http://schemas.paychex.com/enterprise/serviceResponse/ServiceResponseInfo_1\" xmlns:ns20=\"http://schemas.paychex.com/es/client/ClientAddMsg_1_0\" xmlns:ns21=\"http://schemas.paychex.com/es/client/ClientSplitAppAcctMsg_1_0\" xmlns:ns22=\"http://schemas.paychex.com/es/client/ClientLookupResp_1_0\" xmlns:ns23=\"http://schemas.paychex.com/es/client/ClientRelatedAppAcct_1_0\" xmlns:ns24=\"http://schemas.paychex.com/es/client/ClientSplitNotifReq_1_0\" xmlns:ns25=\"http://xml.paychex.com/paychex/payroll/reporting/v1/ReportOptionsData_1/\" xmlns:ns26=\"http://xml.paychex.com/paychex/enterprise/report/v1/ReportOption_1/\" xmlns:ns27=\"http://xml.paychex.com/paychex/enterprise/common/v3/TypedKeyValuePair_3\" xmlns:ns28=\"http://schemas.paychex.com/enterprise/security/claims/Identity_1\" xmlns:ns29=\"http://schemas.paychex.com/enterprise/keyValuePair/TypedKeyValuePair_2\" xmlns:ns3=\"http://schemas.paychex.com/enterprise/serviceResponse/ServiceResponse_1\" xmlns:ns30=\"http://schemas.paychex.com/enterprise/payxEntityId/PayxEntityId_1_0\" xmlns:ns31=\"http://schemas.paychex.com/enterprise/security/claims/SecurityComponents_1\" xmlns:ns32=\"http://schemas.paychex.com/enterprise/security/claims/Permission_1\" xmlns:ns33=\"http://schemas.paychex.com/enterprise/product/Product_1\" xmlns:ns34=\"http://services.paychex.com/payx/SSOUserRegistration_1_0\" xmlns:ns35=\"http://xml.paychex.com/paychex/enterprise/common/v4/\" xmlns:ns36=\"http://xml.paychex.com/paychex/enterprise/regulations/v1/\" xmlns:ns37=\"http://www.openapplications.org/oagis/v9/\" xmlns:ns38=\"http://www.hr-xml.org/v3/\" xmlns:ns39=\"http://xml.paychex.com/paychex/enterprise/financial/v1/\" xmlns:ns4=\"http://xml.paychex.com/paychex/enterprise/report/ws/v1/\" xmlns:ns40=\"http://xml.paychex.com/paychex/enterprise/client/v2/\" xmlns:ns41=\"http://xml.paychex.com/paychex/payroll/v1/\" xmlns:ns42=\"urn:swift:xsd:pain001\" xmlns:ns43=\"urn:swift:xsd:pain002\" xmlns:ns44=\"http://xml.paychex.com/paychex/enterprise/product/v1/\" xmlns:ns45=\"http://xml.paychex.com/paychex/enterprise/filter/v1/\" xmlns:ns46=\"http://xml.paychex.com/paychex/enterprise/service/v1/\" xmlns:ns47=\"http://xml.paychex.com/paychex/enterprise/worker/v1/\" xmlns:ns48=\"http://xml.paychex.com/paychex/payroll/dataimport/v3/ws/\" xmlns:ns49=\"http://xml.paychex.com/paychex/payroll/dataimport/v3/\" xmlns:ns5=\"http://xml.paychex.com/paychex/enterprise/report/v1/ReportSecurity_1\" xmlns:ns50=\"http://www.hr-xml.org/3\" xmlns:ns51=\"http://www.openapplications.org/oagis/9\" xmlns:ns52=\"http://schemas.paychex.com/enterprise/security/claims/Identity_3\" xmlns:ns53=\"http://schemas.paychex.com/enterprise/security/claims/SecurityComponents_3\" xmlns:ns54=\"http://schemas.paychex.com/enterprise/security/claims/PaychexUser_2\" xmlns:ns55=\"http://schemas.paychex.com/enterprise/metadata/MessageInfo_1\" xmlns:ns56=\"http://schemas.paychex.com/enterprise/metadata/OriginatorInfo_1\" xmlns:ns57=\"http://schemas.paychex.com/enterprise/metadata/TimingInfo_1\" xmlns:ns58=\"http://services.paychex.com/payx/UserWebflowService_1_0\" xmlns:ns59=\"http://schemas.paychex.com/payxSSO/SSOUser_1\" xmlns:ns6=\"http://schemas.paychex.com/es/client/EntRequestor_1_0\" xmlns:ns60=\"http://schemas.paychex.com/enterprise/security/claims/PaychexUser_1\" xmlns:ns61=\"http://schemas.paychex.com/faults/OperationInfo_1_0\" xmlns:ns62=\"http://services.paychex.com/payx/DataportalService/Types_2\" xmlns:ns63=\"http://xml.paychex.com/paychex/enterprise/user/v2/ws/\" xmlns:ns64=\"http://schemas.paychex.com/payx/Internal_LDAP_1\" xmlns:ns65=\"http://xml.paychex.com/paychex/payroll/locking/v1/ws/\" xmlns:ns66=\"http://xml.paychex.com/paychex/payroll/locking/v1/\" xmlns:ns67=\"http://schemas.paychex.com/enterprise/validationResult/ValidationResult_1\" xmlns:ns68=\"http://schemas.paychex.com/enterprise/properties/Properties_1\" xmlns:ns69=\"http://schemas.paychex.com/enterprise/serviceResponse/ServiceResponse_2\" xmlns:ns7=\"http://schemas.paychex.com/enterprise/security/claims/Permission_2\" xmlns:ns70=\"http://schemas.paychex.com/enterprise/proposedResolution/ProposedResolution_1\" xmlns:ns71=\"http://services.paychex.com/payx/worker/BasicWorkerDataAccess_1_0\" xmlns:ns72=\"http://schemas.paychex.com/payxHR-XML-3_0/UserAccountExt_1\" xmlns:ns73=\"http://schemas.paychex.com/enterprise/security/claims/Roles_1\" xmlns:ns74=\"http://xml.paychex.com/paychex/enterprise/portal/v2/\" xmlns:ns75=\"http://xml.paychex.com/paychex/enterprise/worker/v1/ws/\" xmlns:ns76=\"http://schemas.paychex.com/enterprise/client/ClientProductSubscription_1\" xmlns:ns77=\"http://xml.paychex.com/paychex/payroll/notes/v1/ws/\" xmlns:ns78=\"http://xml.paychex.com/paychex/payroll/notes/v1/\" xmlns:ns79=\"http://xml.paychex.com/paychex/enterprise/portal/v2/ws/\" xmlns:ns8=\"http://services.paychex.com/payx/uc_1\" xmlns:ns80=\"http://xml.paychex.com/paychex/enterprise/client/v2/ws/\" xmlns:ns81=\"http://schemas.paychex.com/enterprise/security/claims/SecurityComponents_2\" xmlns:ns82=\"http://xml.paychex.com/paychex/payroll/reporting/v1/ReportGenerationService_1\" xmlns:ns83=\"http://services.paychex.com/payx/MigrationToolService_1_0\" xmlns:ns84=\"http://xml.paychex.com/paychex/enterprise/common/v2/GenericFault_2/\" xmlns:ns85=\"http://schemas.paychex.com/faults/GenericFault_1_0\" xmlns:ns86=\"http://services.paychex.com/payx/PNGUserStore_1_0\" xmlns:ns87=\"http://xml.paychex.com/paychex/enterprise/subscription/v2/ws/\" xmlns:ns88=\"http://schemas.paychex.com/enterprise/security/claims/SoftwareApplicationSystem_1\" xmlns:ns89=\"http://xml.paychex.com/paychex/enterprise/financial/v1/ws/\" xmlns:ns9=\"http://schemas.paychex.com/es/client/ClientAcctRegisterMsg_1_0\" xmlns:ns90=\"http://xml.paychex.com/paychex/enterprise/entitlement/v2/ws/\" xmlns:ns91=\"http://services.paychex.com/payx/client/ClientProductSubscriptionService_1_0\" xmlns:ns92=\"http://schemas.paychex.com/es/fault/EntIdFault_1_0\" xmlns:ns93=\"http://schemas.paychex.com/enterprise/payx/UserLdapType_1\" xmlns:ns94=\"http://schemas.paychex.com/enterprise/domain/worker/BasicWorker_1\"><ns87:ssoGuid>00OJBKYHHJIOJ7VKE4BV</ns87:ssoGuid><ns87:ldapType>EXTERNAL</ns87:ldapType></ns87:getEnterpriseUser></S:Body></S:Envelope>"
        postRequest(url, headers, params);
    }

    testClientProductSubscription();


    return;


    function performPost() {
        var p = new ProxyRequst()
        p.request(url, function onDone(data) {
            console.log('data post:', data)
        }, headers, params)
    }

    performPost()
    function performGet() {
        var p = new ProxyRequst()
        p.request(get_url, function onDone(data) {
            console.log('data...', 'get', data)
        }, {}, null, {method: 'GET'})
    }

    //performGet()
}
exports.ProxyRequest.test = test;

if (module.parent == null) {
    test()
}