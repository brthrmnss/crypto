/**
 * Created by yx41 on 1/3/14.
 */
var sh = require('shelpers').shelpers;

function GenerateData() {
    var p = GenerateData.prototype;
    p = this;
    var self = this;
    /**
     * Simple creation method
     * @param times
     * @param appCode
     */
    p.create = function create(times, callback) {

        var config = {}
        config.times = times;
        config.fx = callback;
        if ( sh.isObject(times) && ! sh.isArray(times)) {
            config = times;
        }


        var items = []

        if ( sh.isArray(config.times)) {
            var baseItems = config.times;
            config.times = baseItems.length;
        }

        for (var i = 0; i < config.times; i++) {
            var item = {}
            if ( baseItems != null ) {
                item = baseItems[i];
            }
            var chance = Math.random();
            var dp = {}
            dp.chance = chance;
            var result = config.fx(item, i, dp)
            //create no more items if null
            if ( result == false ) {
                break;
            }


            if (config.requiredFields != null ) {
                   sh.each(config.requiredFields, function validateField(k,v) {
                       if ( item[k] == null ) {
                            throw 'k is null ' + k + config.name;
                       }
                   })
            }

            items.push(item)


        }



        return items;

    }

    p.proc = function debugLogger() {
        if ( self.silent == true) {
            return
        }
        sh.sLog(arguments)
    }


}


GenerateData.getName = function genName() {
    return 'Test Name'
}

if (module.parent == null) {

}


exports.GenerateData = GenerateData;

